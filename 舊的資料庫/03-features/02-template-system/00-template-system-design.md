# ç”³ç·¨å–®æ¨¡æ¿ç³»çµ±è¨­è¨ˆæ–‡ä»¶

> **å»ºç«‹æ—¥æœŸ**: 2025-01-XX
> **ç‰ˆæœ¬**: 1.0
> **ç‹€æ…‹**: Phase 1 å·²å¯¦ä½œï¼ˆå‰ç«¯ localStorageï¼‰

---

## ğŸ“‹ ç›®éŒ„

1. [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
2. [ç›®å‰å¯¦ä½œï¼ˆPhase 1ï¼‰](#ç›®å‰å¯¦ä½œphase-1)
3. [è³‡æ–™çµæ§‹](#è³‡æ–™çµæ§‹)
4. [å‰ç«¯å¯¦ä½œç´°ç¯€](#å‰ç«¯å¯¦ä½œç´°ç¯€)
5. [å¾Œç«¯æ•´åˆè¦åŠƒï¼ˆPhase 2ï¼‰](#å¾Œç«¯æ•´åˆè¦åŠƒphase-2)
6. [æœªä¾†æ“´å……åŠŸèƒ½](#æœªä¾†æ“´å……åŠŸèƒ½)
7. [å‡ç´šè·¯å¾‘](#å‡ç´šè·¯å¾‘)
8. [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## åŠŸèƒ½æ¦‚è¿°

### éœ€æ±‚èƒŒæ™¯

åœ¨å¡«å¯«æµ·è»æ–™è™Ÿç”³ç·¨å–®æ™‚ï¼Œè¨±å¤šæ¬„ä½ï¼ˆä¾‹å¦‚ï¼šå–®ä½æœƒè¨ˆç·¨è™Ÿã€ç³»çµ±ä»£è™Ÿã€è‰¦å‹ç­‰ï¼‰åœ¨åŒä¸€å–®ä½æˆ–åŒä¸€å°ˆæ¡ˆä¸­é€šå¸¸æ˜¯å›ºå®šçš„ã€‚ç‚ºäº†æå‡ä½¿ç”¨è€…å¡«å¯«æ•ˆç‡ï¼Œè¨­è¨ˆäº†**æ¨¡æ¿ç³»çµ±**ï¼Œè®“ä½¿ç”¨è€…èƒ½å¤ ï¼š

1. **å¿«é€Ÿå¥—ç”¨é è¨­å€¼** - ä¸€éµå¡«å…¥å¸¸ç”¨æ¬„ä½
2. **å„²å­˜å¸¸ç”¨è¨­å®š** - å°‡å¸¸å¡«çš„æ¬„ä½çµ„åˆå„²å­˜ç‚ºæ¨¡æ¿ï¼ˆæœªä¾†å¯¦ä½œï¼‰
3. **ç®¡ç†å¤šå€‹æ¨¡æ¿** - æ”¯æ´ä¸åŒå°ˆæ¡ˆ/å–®ä½çš„å¤šçµ„è¨­å®šï¼ˆæœªä¾†å¯¦ä½œï¼‰

### æ ¸å¿ƒåŠŸèƒ½ï¼ˆPhase 1ï¼‰

- âœ… **æ¨¡æ¿å¥—ç”¨** - é»æ“Šã€Œå¥—ç”¨ã€æŒ‰éˆ•ï¼Œè‡ªå‹•å¡«å…¥ 17 å€‹æ¬„ä½
- âœ… **é è¨­æ¨¡æ¿** - ç³»çµ±é è¨­æä¾›ã€Œæ¨¡æ¿1ã€
- âœ… **æ¨¡æ¿é¸æ“‡å½ˆçª—** - å¡ç‰‡å¼è¨­è¨ˆï¼Œæ”¯æ´ hover é¡¯ç¤ºæ“ä½œæŒ‰éˆ•
- âœ… **localStorage å„²å­˜** - è³‡æ–™å­˜åœ¨ä½¿ç”¨è€…ç€è¦½å™¨ï¼ˆç„¡éœ€å¾Œç«¯ï¼‰

### é ç•™åŠŸèƒ½ï¼ˆPhase 2+ï¼‰

- ğŸ”„ å„²å­˜æ–°æ¨¡æ¿ï¼ˆå¾ç›®å‰è¡¨å–®æ”¶é›†è³‡æ–™ï¼‰
- ğŸ”„ ç·¨è¼¯æ¨¡æ¿åç¨±
- ğŸ”„ åˆªé™¤æ¨¡æ¿
- ğŸ”„ è¨­å®šé è¨­æ¨¡æ¿ï¼ˆé–‹å•Ÿè¡¨å–®æ™‚è‡ªå‹•å¥—ç”¨ï¼‰
- ğŸ”„ å¾Œç«¯ API æ•´åˆï¼ˆè·¨è£ç½®åŒæ­¥ï¼‰
- ğŸ”„ æ¨¡æ¿åˆ†äº«ï¼ˆç®¡ç†å“¡åŠŸèƒ½ï¼‰

---

## ç›®å‰å¯¦ä½œï¼ˆPhase 1ï¼‰

### UI è¨­è¨ˆ

#### 1. æ¨™é¡Œå€åŸŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                     â”‚
â”‚       æµ·è»æ–™è™Ÿç”³ç·¨å–® (3rem å¤§æ¨™é¡Œ)        [é¸æ“‡æ¨¡æ¿] â”‚
â”‚       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- æ¨™é¡Œå­—é«”æ”¾å¤§åˆ° `3rem`
- å³å´æ–°å¢ã€Œé¸æ“‡æ¨¡æ¿ã€æŒ‰éˆ•
- ä½¿ç”¨ `position: relative` + `absolute` ä½ˆå±€

#### 2. æ¨¡æ¿é¸æ“‡å½ˆçª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¸æ“‡æ¨¡æ¿                              [Ã—]   â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ğŸ“„ æ¨¡æ¿1      â”‚  â”‚ ğŸ“„ æ¨¡æ¿2      â”‚        â”‚
â”‚  â”‚ 2025/01/15   â”‚  â”‚ (æœªä¾†æ“´å……)    â”‚        â”‚
â”‚  â”‚ åŒ…å« 17 æ¬„ä½ â”‚  â”‚               â”‚        â”‚
â”‚  â”‚              â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ [Hoveré¡¯ç¤º]  â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ â”‚ âœ“ å¥—ç”¨  â”‚ â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ â”‚ ğŸ’¾ å„²å­˜ â”‚ â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ â”‚ ğŸ—‘ï¸ åˆªé™¤ â”‚ â”‚  â”‚               â”‚        â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚               â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½¿ç”¨æµç¨‹

1. ä½¿ç”¨è€…é»æ“Šã€Œé¸æ“‡æ¨¡æ¿ã€æŒ‰éˆ•
2. é–‹å•Ÿæ¨¡æ¿é¸æ“‡å½ˆçª—ï¼Œé¡¯ç¤ºã€Œæ¨¡æ¿1ã€å¡ç‰‡
3. æ»‘é¼ ç§»åˆ°å¡ç‰‡ä¸Šï¼Œé¡¯ç¤ºã€Œå¥—ç”¨ã€æŒ‰éˆ•ï¼ˆå„²å­˜/åˆªé™¤æŒ‰éˆ•å·²é ç•™ä½†è¨»è§£æ‰ï¼‰
4. é»æ“Šã€Œå¥—ç”¨ã€
5. è‡ªå‹•å¡«å…¥ 17 å€‹è¡¨å–®æ¬„ä½
6. å½ˆçª—é—œé–‰ï¼Œé¡¯ç¤ºæˆåŠŸè¨Šæ¯

---

## è³‡æ–™çµæ§‹

### æ¨¡æ¿ç‰©ä»¶æ ¼å¼

```javascript
{
  id: 'template_1',              // å”¯ä¸€è­˜åˆ¥ç¢¼
  name: 'æ¨¡æ¿1',                  // æ¨¡æ¿åç¨±
  created_at: '2025-01-15T10:30:00.000Z',  // å»ºç«‹æ™‚é–“ï¼ˆISO 8601ï¼‰
  updated_at: '2025-01-15T14:20:00.000Z',  // æ›´æ–°æ™‚é–“ï¼ˆå¯é¸ï¼‰
  data: {                         // è¡¨å–®æ¬„ä½è³‡æ–™
    accounting_unit_code: 'B21317',
    issue_unit: 'EA',
    unit_price: '20000.00',
    spec_indicator: 'E',
    unit_pack_quantity: '1',
    storage_life_months: '0',
    storage_life_action_code: '00',
    storage_type_code: 'R',
    secrecy_code: 'U',
    expendability_code: 'N',
    repairability_code: '9',
    manufacturability_code: 'E',
    source_code: '5',
    system_code: 'C35',
    category_code: 'E',
    pn_acquisition_level: '2',
    pn_acquisition_source: '3'
  }
}
```

### æ¬„ä½èªªæ˜

| æ¬„ä½åç¨± | ä¸­æ–‡åç¨± | è³‡æ–™å‹æ…‹ | èªªæ˜ |
|---------|---------|---------|------|
| `accounting_unit_code` | å–®ä½æœƒè¨ˆç·¨è™Ÿ | String | ä¾‹å¦‚ï¼šB21317 |
| `issue_unit` | æ’¥ç™¼å–®ä½ | String | é¸å–®å€¼ï¼šEA |
| `unit_price` | ç¾é‡‘å–®åƒ¹ | String | æ•¸å­—ï¼Œä¾‹å¦‚ï¼š20000.00 |
| `spec_indicator` | è¦æ ¼æŒ‡ç¤º | String | é¸å–®å€¼ï¼šE |
| `unit_pack_quantity` | å–®ä½åŒ…è£é‡ | String | é¸å–®å€¼ï¼š1 |
| `storage_life_months` | å­˜å„²å£½é™ | String | é¸å–®å€¼ï¼š0 |
| `storage_life_action_code` | å£½é™è™•ç† | String | é¸å–®å€¼ï¼š00 |
| `storage_type_code` | å„²å­˜å‹å¼ | String | é¸å–®å€¼ï¼šR |
| `secrecy_code` | æ©Ÿå¯†æ€§ä»£è™Ÿ | String | é¸å–®å€¼ï¼šU |
| `expendability_code` | æ¶ˆè€—æ€§ä»£è™Ÿ | String | é¸å–®å€¼ï¼šN |
| `repairability_code` | ä¿®ç†èƒ½é‡ | String | é¸å–®å€¼ï¼š9 |
| `manufacturability_code` | è£½é€ èƒ½é‡ | String | é¸å–®å€¼ï¼šE |
| `source_code` | ä¾†æºä»£è™Ÿ | String | é¸å–®å€¼ï¼š5 |
| `system_code` | ç³»çµ±ä»£è™Ÿ | String | ä¾‹å¦‚ï¼šC35 |
| `category_code` | æª”åˆ¥ä»£è™Ÿ | String | é¸å–®å€¼ï¼šE |
| `pn_acquisition_level` | P/Nç²å¾—ç¨‹åº¦ | String | ä¾‹å¦‚ï¼š2 |
| `pn_acquisition_source` | P/Nç²å¾—ä¾†æº | String | ä¾‹å¦‚ï¼š3 |

### localStorage å„²å­˜æ ¼å¼

**å„²å­˜éµ**: `application_form_templates`

**å€¼**: JSON å­—ä¸²ï¼ˆæ¨¡æ¿é™£åˆ—ï¼‰

```json
[
  {
    "id": "template_1",
    "name": "æ¨¡æ¿1",
    "created_at": "2025-01-15T10:30:00.000Z",
    "data": { ... }
  },
  {
    "id": "template_2",
    "name": "è‰¦ç”¨é›»æ©Ÿç³»çµ±",
    "created_at": "2025-01-16T09:00:00.000Z",
    "data": { ... }
  }
]
```

---

## å‰ç«¯å¯¦ä½œç´°ç¯€

### æª”æ¡ˆä½ç½®

- **HTML/CSS/JS**: `app/templates/application/application_form.html`
  - è¡Œ 1240-1256: æ¨™é¡Œå€åŸŸ
  - è¡Œ 1689-1720: æ¨¡æ¿é¸æ“‡å½ˆçª— HTML
  - è¡Œ 1218-1375: CSS æ¨£å¼
  - è¡Œ 4240-4586: JavaScript æ¨¡æ¿ç®¡ç†å™¨

### JavaScript æ¨¡çµ„ï¼šTemplateManager

#### ä¸»è¦æ–¹æ³•

| æ–¹æ³•åç¨± | åŠŸèƒ½ | å¯¦ä½œç‹€æ…‹ |
|---------|------|---------|
| `init()` | åˆå§‹åŒ–æ¨¡æ¿ç®¡ç†å™¨ | âœ… |
| `ensureDefaultTemplate()` | ç¢ºä¿é è¨­æ¨¡æ¿å­˜åœ¨ | âœ… |
| `bindEvents()` | ç¶å®šæŒ‰éˆ•äº‹ä»¶ | âœ… |
| `openTemplateModal()` | é–‹å•Ÿæ¨¡æ¿é¸æ“‡å½ˆçª— | âœ… |
| `renderTemplateList()` | æ¸²æŸ“æ¨¡æ¿å¡ç‰‡åˆ—è¡¨ | âœ… |
| `createTemplateCard(template)` | å»ºç«‹å–®ä¸€æ¨¡æ¿å¡ç‰‡ HTML | âœ… |
| `bindCardEvents()` | ç¶å®šå¡ç‰‡æŒ‰éˆ•äº‹ä»¶ | âœ… |
| `applyTemplate(templateId)` | å¥—ç”¨æ¨¡æ¿åˆ°è¡¨å–® | âœ… |
| `getTemplates()` | å¾ localStorage è®€å–æ¨¡æ¿ | âœ… |
| `saveTemplate(template)` | å„²å­˜æ¨¡æ¿åˆ° localStorage | âœ… |
| `deleteTemplate(templateId)` | åˆªé™¤æ¨¡æ¿ï¼ˆå·²å¯¦ä½œä½†æœªå•Ÿç”¨ï¼‰ | ğŸ”„ |
| `saveCurrentFormAsTemplate(name)` | å„²å­˜ç›®å‰è¡¨å–®ç‚ºæ¨¡æ¿ | ğŸ”„ é ç•™ |
| `editTemplateName(id, name)` | ç·¨è¼¯æ¨¡æ¿åç¨± | ğŸ”„ é ç•™ |
| `setDefaultTemplate(id)` | è¨­å®šé è¨­æ¨¡æ¿ | ğŸ”„ é ç•™ |
| `syncWithBackend()` | èˆ‡å¾Œç«¯åŒæ­¥ | ğŸ”„ é ç•™ |

#### å¥—ç”¨é‚è¼¯

```javascript
applyTemplate(templateId) {
  // 1. å¾ localStorage å–å¾—æ¨¡æ¿
  const template = this.getTemplates().find(t => t.id === templateId);

  // 2. éæ­·æ‰€æœ‰æ¬„ä½
  Object.entries(template.data).forEach(([fieldName, value]) => {
    const input = document.getElementById(fieldName);

    // 3. æ ¹æ“šå…ƒç´ é¡å‹è¨­å®šå€¼
    if (input.tagName === 'SELECT') {
      // ä¸‹æ‹‰é¸å–®ï¼šæª¢æŸ¥é¸é …æ˜¯å¦å­˜åœ¨
      const option = Array.from(input.options).find(opt => opt.value === value);
      if (option) {
        input.value = value;
      }
    } else {
      // ä¸€èˆ¬ inputï¼šç›´æ¥è¨­å®š
      input.value = value;
    }
  });

  // 4. é—œé–‰å½ˆçª—
  modal.hide();

  // 5. é¡¯ç¤ºæˆåŠŸè¨Šæ¯
  toastManager.showToast('success', 'å·²å¥—ç”¨æ¨¡æ¿');
}
```

### CSS é‡é»æ¨£å¼

#### æ¨¡æ¿å¡ç‰‡

```css
.template-card {
  background: linear-gradient(135deg, rgba(0, 212, 255, 0.08), rgba(0, 150, 200, 0.05));
  border: 2px solid rgba(0, 212, 255, 0.3);
  border-radius: 12px;
  min-height: 180px;
  transition: all 0.3s ease;
}

.template-card:hover {
  border-color: #00d4ff;
  box-shadow: 0 8px 24px rgba(0, 212, 255, 0.3);
  transform: translateY(-5px);
}
```

#### Hover æ“ä½œæŒ‰éˆ•

```css
.template-card-actions {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.85);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.template-card:hover .template-card-actions {
  opacity: 1;
}
```

---

## å¾Œç«¯æ•´åˆè¦åŠƒï¼ˆPhase 2ï¼‰

### API ç«¯é»è¨­è¨ˆ

#### 1. å–å¾—ä½¿ç”¨è€…çš„æ‰€æœ‰æ¨¡æ¿

```
GET /api/application/templates
```

**Response:**
```json
{
  "success": true,
  "templates": [
    {
      "id": "uuid-1",
      "name": "æ¨¡æ¿1",
      "created_at": "2025-01-15T10:30:00Z",
      "updated_at": "2025-01-15T14:20:00Z",
      "data": { ... }
    }
  ]
}
```

#### 2. å„²å­˜æ–°æ¨¡æ¿

```
POST /api/application/templates
Content-Type: application/json

{
  "name": "æ–°æ¨¡æ¿",
  "data": {
    "accounting_unit_code": "B21317",
    ...
  }
}
```

**Response:**
```json
{
  "success": true,
  "template_id": "uuid-new",
  "message": "æ¨¡æ¿å·²å„²å­˜"
}
```

#### 3. æ›´æ–°æ¨¡æ¿

```
PUT /api/application/templates/<template_id>
Content-Type: application/json

{
  "name": "æ›´æ–°çš„åç¨±",
  "data": { ... }
}
```

#### 4. åˆªé™¤æ¨¡æ¿

```
DELETE /api/application/templates/<template_id>
```

**Response:**
```json
{
  "success": true,
  "message": "æ¨¡æ¿å·²åˆªé™¤"
}
```

### è³‡æ–™è¡¨è¨­è¨ˆ

ä½¿ç”¨ç¾æœ‰çš„ `web_app.user_settings` è¡¨ï¼š

| æ¬„ä½ | é¡å‹ | èªªæ˜ |
|-----|------|------|
| `setting_id` | UUID | ä¸»éµ |
| `user_id` | UUID | å¤–éµ (users.id) |
| `setting_key` | String(100) | ä¾‹å¦‚ï¼š`application_form_template_<uuid>` |
| `setting_value` | Text | JSON æ ¼å¼çš„æ¨¡æ¿è³‡æ–™ |
| `created_at` | DateTime | å»ºç«‹æ™‚é–“ |
| `updated_at` | DateTime | æ›´æ–°æ™‚é–“ |

**ç¯„ä¾‹è³‡æ–™:**

```sql
INSERT INTO web_app.user_settings (setting_id, user_id, setting_key, setting_value)
VALUES (
  gen_random_uuid(),
  'user-uuid',
  'application_form_template_abc123',
  '{"template_name": "æ¨¡æ¿1", "template_data": {...}}'
);
```

### å‰ç«¯å‡ç´šæ­¥é©Ÿ

ç•¶å¾Œç«¯ API å®Œæˆå¾Œï¼Œåªéœ€ä¿®æ”¹ä»¥ä¸‹ 3 è™•ï¼š

**1. `getTemplates()` æ–¹æ³•**

```javascript
// åŸæœ¬ï¼š
getTemplates() {
  const data = localStorage.getItem(this.STORAGE_KEY);
  return data ? JSON.parse(data) : [];
}

// æ”¹ç‚ºï¼š
async getTemplates() {
  const response = await fetch('/api/application/templates');
  const data = await response.json();
  return data.success ? data.templates : [];
}
```

**2. `saveTemplate()` æ–¹æ³•**

```javascript
// åŸæœ¬ï¼š
saveTemplate(template) {
  const templates = this.getTemplates();
  templates.push(template);
  localStorage.setItem(this.STORAGE_KEY, JSON.stringify(templates));
}

// æ”¹ç‚ºï¼š
async saveTemplate(template) {
  const response = await fetch('/api/application/templates', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(template)
  });
  return await response.json();
}
```

**3. `deleteTemplate()` æ–¹æ³•**

```javascript
// åŸæœ¬ï¼š
deleteTemplate(templateId) {
  let templates = this.getTemplates();
  templates = templates.filter(t => t.id !== templateId);
  localStorage.setItem(this.STORAGE_KEY, JSON.stringify(templates));
}

// æ”¹ç‚ºï¼š
async deleteTemplate(templateId) {
  const response = await fetch(`/api/application/templates/${templateId}`, {
    method: 'DELETE'
  });
  return await response.json();
}
```

---

## æœªä¾†æ“´å……åŠŸèƒ½

### Phase 2ï¼šå®Œæ•´æ¨¡æ¿ç®¡ç†

- [ ] æ–°å¢ã€Œå„²å­˜ç‚ºæ¨¡æ¿ã€æŒ‰éˆ•ï¼ˆåœ¨è¡¨å–®åº•éƒ¨ï¼‰
- [ ] å•Ÿç”¨ã€Œåˆªé™¤ã€æŒ‰éˆ•ï¼ˆéœ€ç¢ºèªå°è©±æ¡†ï¼‰
- [ ] å•Ÿç”¨ã€Œç·¨è¼¯åç¨±ã€åŠŸèƒ½ï¼ˆinline ç·¨è¼¯æˆ–å½ˆçª—ï¼‰

### Phase 3ï¼šé€²éšåŠŸèƒ½

- [ ] è¨­å®šã€Œé è¨­æ¨¡æ¿ã€ï¼ˆé–‹å•Ÿè¡¨å–®æ™‚è‡ªå‹•å¥—ç”¨ï¼‰
- [ ] æ¨¡æ¿æ¨™ç±¤/åˆ†é¡ï¼ˆä¾‹å¦‚ï¼šè‰¦å‹ã€ç³»çµ±ï¼‰
- [ ] æ¨¡æ¿ä½¿ç”¨çµ±è¨ˆï¼ˆæœ€å¸¸ç”¨çš„æ¨¡æ¿ï¼‰
- [ ] æ¨¡æ¿é è¦½ï¼ˆä¸å¥—ç”¨ï¼ŒåªæŸ¥çœ‹å…§å®¹ï¼‰

### Phase 4ï¼šå”ä½œåŠŸèƒ½

- [ ] æ¨¡æ¿åŒ¯å‡º/åŒ¯å…¥ï¼ˆJSON æª”æ¡ˆï¼‰
- [ ] æ¨¡æ¿åˆ†äº«ï¼ˆç®¡ç†å“¡å»ºç«‹å…¬ç”¨æ¨¡æ¿ï¼‰
- [ ] æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶ï¼ˆè¿½è¹¤ä¿®æ”¹æ­·å²ï¼‰

---

## å‡ç´šè·¯å¾‘

### å¾ Phase 1 å‡ç´šåˆ° Phase 2ï¼ˆå¾Œç«¯æ•´åˆï¼‰

**æ­¥é©Ÿï¼š**

1. **å»ºç«‹å¾Œç«¯ API**
   - æ–°å¢ `app/application/api.py`ï¼ˆæˆ–åœ¨ `routes.py` ä¸­æ–°å¢ï¼‰
   - å¯¦ä½œ 4 å€‹ç«¯é»ï¼ˆGET, POST, PUT, DELETEï¼‰

2. **ä¿®æ”¹å‰ç«¯ JavaScript**
   - å°‡ `localStorage` å‘¼å«æ”¹ç‚º `fetch()` API å‘¼å«
   - è™•ç†éåŒæ­¥ï¼ˆasync/awaitï¼‰
   - åŠ ä¸ŠéŒ¯èª¤è™•ç†

3. **è³‡æ–™é·ç§»ï¼ˆå¯é¸ï¼‰**
   - æä¾›å·¥å…·è®“ä½¿ç”¨è€…å°‡ localStorage è³‡æ–™åŒ¯å‡º
   - åŒ¯å…¥åˆ°è³‡æ–™åº«

4. **æ¸¬è©¦**
   - ç¢ºä¿æ–°å¢/åˆªé™¤/å¥—ç”¨åŠŸèƒ½æ­£å¸¸
   - æ¸¬è©¦è·¨è£ç½®åŒæ­¥

**é è¨ˆå·¥ä½œé‡**: 4-6 å°æ™‚

---

## å¸¸è¦‹å•é¡Œ

### Q1: ç‚ºä»€éº¼å…ˆç”¨ localStorage è€Œä¸ç›´æ¥åšå¾Œç«¯ï¼Ÿ

**A**:
- **å¿«é€Ÿé©—è­‰** - å…ˆè®“åŠŸèƒ½é‹ä½œï¼Œç¢ºèªä½¿ç”¨è€…éœ€æ±‚
- **é™ä½è¤‡é›œåº¦** - ä¸éœ€è³‡æ–™åº«é·ç§»ï¼Œä¸éœ€å¾Œç«¯é–‹ç™¼
- **æ¼¸é€²å¼å‡ç´š** - ç¨‹å¼ç¢¼å·²é ç•™ API ä»‹é¢ï¼Œå‡ç´šåªéœ€æ”¹ 3 è¡Œ

### Q2: localStorage çš„è³‡æ–™æœƒéºå¤±å—ï¼Ÿ

**A**:
- æ˜¯çš„ï¼Œæ¸…é™¤ç€è¦½å™¨è³‡æ–™æœƒéºå¤±
- ä½†ç›®å‰éšæ®µåªæœ‰ 1 å€‹é è¨­æ¨¡æ¿ï¼Œå³ä½¿éºå¤±ä¹Ÿæœƒè‡ªå‹•é‡å»º
- Phase 2 å‡ç´šå¾ŒæœƒåŒæ­¥åˆ°å¾Œç«¯ï¼Œä¸æœƒéºå¤±

### Q3: å¦‚ä½•æ–°å¢æ›´å¤šé è¨­æ¨¡æ¿ï¼Ÿ

**A**:
ä¿®æ”¹ `DEFAULT_TEMPLATE` ç‰©ä»¶ï¼Œæˆ–åœ¨ `ensureDefaultTemplate()` ä¸­æ–°å¢å¤šå€‹æ¨¡æ¿ï¼š

```javascript
ensureDefaultTemplate() {
  const templates = this.getTemplates();

  if (templates.length === 0) {
    this.saveTemplate(this.DEFAULT_TEMPLATE);
    this.saveTemplate({
      id: 'template_2',
      name: 'æ¨¡æ¿2',
      created_at: new Date().toISOString(),
      data: { ... }
    });
  }
}
```

### Q4: å¯ä»¥è·¨ç€è¦½å™¨ä½¿ç”¨å—ï¼Ÿ

**A**:
- **Phase 1**: ä¸è¡Œï¼ŒlocalStorage æ˜¯ç€è¦½å™¨ç¨ç«‹çš„
- **Phase 2**: å¯ä»¥ï¼Œè³‡æ–™å­˜åœ¨å¾Œç«¯ä¼ºæœå™¨

### Q5: å¦‚ä½•æ¸¬è©¦åˆªé™¤/ç·¨è¼¯åŠŸèƒ½ï¼Ÿ

**A**:
åœ¨ç€è¦½å™¨ Console ä¸­åŸ·è¡Œï¼š

```javascript
// å–å¾— TemplateManager å¯¦ä¾‹ï¼ˆå‡è¨­å·²åˆå§‹åŒ–ï¼‰
const tm = TemplateManager;

// æ¸¬è©¦åˆªé™¤
tm.deleteTemplate('template_1');
tm.renderTemplateList();

// æ¸¬è©¦ç·¨è¼¯ï¼ˆæœªä¾†å¯¦ä½œï¼‰
// tm.editTemplateName('template_1', 'æ–°åç¨±');
```

---

## æŠ€è¡“ç­†è¨˜

### ç‚ºä½•ä½¿ç”¨ `data-template-id` è€Œä¸æ˜¯ `id`ï¼Ÿ

ä½¿ç”¨ `data-*` å±¬æ€§è€Œé HTML `id` æ˜¯å› ç‚ºï¼š
- HTML `id` å¿…é ˆå”¯ä¸€ï¼Œä½†æ¨¡æ¿ ID å¯èƒ½é‡è¤‡ï¼ˆä¾‹å¦‚åœ¨å¤šå€‹åœ°æ–¹é¡¯ç¤ºï¼‰
- `data-*` æ›´èªæ„åŒ–ï¼Œæ¸…æ¥šè¡¨é”ã€Œé€™æ˜¯è³‡æ–™å±¬æ€§ã€
- æ–¹ä¾¿ JavaScript é¸æ“‡å™¨ï¼š`querySelector('[data-template-id="..."]')`

### ç‚ºä½•ä½¿ç”¨ç®­é ­å‡½æ•¸è€Œé `function`ï¼Ÿ

```javascript
// ä½¿ç”¨ç®­é ­å‡½æ•¸
openBtn.addEventListener('click', () => {
  this.openTemplateModal();
});

// è€Œé
openBtn.addEventListener('click', function() {
  this.openTemplateModal();  // âŒ this æœƒæŒ‡å‘ openBtn
});
```

ç®­é ­å‡½æ•¸ä¿ç•™ `this` ç¶å®šåˆ° `TemplateManager` ç‰©ä»¶ã€‚

### å®‰å…¨æ€§è€ƒé‡

1. **XSS é˜²è­·** - ä½¿ç”¨ `textContent` è€Œé `innerHTML` é¡¯ç¤ºä½¿ç”¨è€…è¼¸å…¥
2. **CSRF ä¿è­·** - å¾Œç«¯ API éœ€è¦åŠ ä¸Š CSRF token
3. **æ¬Šé™æ§åˆ¶** - åªèƒ½å­˜å–è‡ªå·±çš„æ¨¡æ¿ï¼ˆuser_id é©—è­‰ï¼‰

---

## çµèª

æœ¬æ–‡ä»¶è¨˜éŒ„äº†ç”³ç·¨å–®æ¨¡æ¿ç³»çµ±çš„å®Œæ•´è¨­è¨ˆèˆ‡å¯¦ä½œç´°ç¯€ã€‚éš¨è‘—ç³»çµ±æ¼”é€²ï¼Œè«‹æŒçºŒæ›´æ–°æ­¤æ–‡ä»¶ã€‚

**æœ€å¾Œæ›´æ–°**: 2025-01-XX
**ç¶­è­·è€…**: Claude Code Assistant
**åƒè€ƒè³‡æ–™**:
- `app/templates/application/application_form.html`
- ä½¿ç”¨è€…éœ€æ±‚è¨è«–è¨˜éŒ„
